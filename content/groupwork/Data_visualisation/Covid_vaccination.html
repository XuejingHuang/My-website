---
title: "Covid Vaccination Analysis"
author: "LBS-MAM22 Group 5"
date: "2021-09-18"
tags: ["groupwork", "data_visualisation"]
output:
  html_document:
    theme: flatly
    highlight: zenburn
    number_sections: yes
    toc: yes
    toc_float: yes
    code_folding: show
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<div id="challenge-1-covid-vaccination-data" class="section level1">
<h1>Challenge 1: COVID Vaccination Data</h1>
<p>We want to replicate a graph from the article <a href="https://acasignups.net/21/07/18/racial-factor-theres-77-counties-which-are-deep-blue-also-low-vaxx-guess-what-they-have">The Racial Factor: Thereâ€™s 77 Counties Which Are Deep Blue But Also Low-Vaxx. Guess What They Have In Common?</a></p>
<p><img src="/Users/huangxuejing/Desktop/AM-01/my-website/images/vaxxes_by_state_red_blue_every_county_070321_1.jpg" width="90%" style="display: block; margin: auto;" /></p>
<pre class="r"><code># 3154 unique fips code in election2020_results
length(unique(election2020_results$fips))</code></pre>
<pre><code>## [1] 3154</code></pre>
<pre class="r"><code># check unique values of candidate names
unique(election2020_results$candidate)</code></pre>
<pre><code>## [1] &quot;JOSEPH R BIDEN JR&quot; &quot;OTHER&quot;             &quot;DONALD J TRUMP&quot;   
## [4] &quot;JO JORGENSEN&quot;</code></pre>
<pre class="r"><code>data &lt;- election2020_results %&gt;% 
  mutate(votes_percentage = candidatevotes/totalvotes) %&gt;% # calculate percentage
  filter(candidate==&quot;DONALD J TRUMP&quot;, mode==&quot;TOTAL&quot;) %&gt;% # we only need Trump votes 
  inner_join(vaccinations,by = &quot;fips&quot;) %&gt;% # inner join with vaccinations data
  inner_join(population,by = &quot;fips&quot;) # inner join with population data


# generate graph below
# install.packages(&quot;ggpubr&quot;) # to show equation easily
library(ggpubr)
# calculate actual vaccination percentage
actual = sum(data$series_complete_yes)/sum(data$pop_estimate_2019)
data %&gt;% 
  # filter out 0% vaccinated points
  filter(series_complete_pop_pct&gt;0) %&gt;%
  ggplot() +
  geom_point(aes(x=votes_percentage,y=series_complete_pop_pct/100,size=pop_estimate_2019),shape=21,fill=&quot;light blue&quot;)+
  
  # scale circle size
  scale_size(range = c(0, 20)) + 
  
  # add points in the center of circles
  geom_point(aes(x=votes_percentage,y=series_complete_pop_pct/100),size=0.5)+ 
  
  # add regression line
  geom_smooth(aes(x=votes_percentage,y=series_complete_pop_pct/100),
              method=&quot;lm&quot;,linetype=&quot;dotted&quot;,colour=&quot;blue&quot;,se=FALSE)+ 
  
  # add the equation of regression line
  stat_regline_equation(aes(x=votes_percentage,y=series_complete_pop_pct/100),
                        label.y = 0.1,colour=&quot;red&quot;,fontface = &quot;bold.italic&quot;) + 
  
  # add r square
  stat_cor(aes(x=votes_percentage,y=series_complete_pop_pct/100,label = paste(..rr.label..)),
           label.y = 0.05,colour=&quot;red&quot;)+ 
  
  # add date
  geom_text(aes(x=0.3, y=0.07,label = &quot;09/03/2021&quot;, 
                fontface = &quot;bold.italic&quot;),colour=&quot;red&quot;)+ 
  
  # add horizonal lines below
  geom_hline(aes(yintercept=0.85), linetype=2) + # herd immunity line
  geom_text(aes(x=0, y=0.85, label = &quot;Herd Immunity threshold (?)&quot;, 
                vjust=-1, hjust=0, fontface = &quot;bold.italic&quot;),colour=&quot;blue&quot;) +
  geom_hline(aes(yintercept=0.539), linetype=2) + # Target line
  geom_text(aes(x=0, y=0.539,label = &quot;TARGET: 53.9%&quot;, 
                vjust=-1,hjust=0, fontface = &quot;bold.italic&quot;),colour=&quot;blue&quot;) +
  geom_hline(aes(yintercept=actual), linetype=2) + # actual line
  geom_text(aes(x=0, y=actual, label = paste(&quot;ACTUAL: &quot;, round(actual*100,1),&quot;%&quot;),
                vjust=-1,hjust=0,fontface = &quot;bold.italic&quot;),
            colour=&quot;blue&quot;) +
  
  # adjuct grid lines
  scale_x_continuous(label=scales::percent_format(accuracy = 1),
                     breaks=seq(0,1,0.05),limits = c(0,1))+
  scale_y_continuous(label=scales::percent_format(accuracy = 1),
                     breaks=seq(0,1,0.05),limits = c(0,1))+
  geom_text(aes(x=0.5,y=1, label = &quot;EACH U.S. COUNTY&quot;,vjust=0.5,hjust=0.5,
                family=&quot;mono&quot;,fontface = &quot;bold&quot;),
            size=5)+
  labs(title = &quot;COVID-19 VACCINATION LEVELS OUT OF TOTAL POPULATION BY COUNTY&quot;,
       x = &quot;2020 Trump Vote %&quot;,
       y = &quot;% of Total Population Vaccinated&quot;)+
  # remove the legend
  theme(legend.position = &quot;none&quot;)+
  NULL</code></pre>
<p><img src="/project/Covid_vaccination_files/figure-html/unnamed-chunk-2-1.png" width="648" style="display: block; margin: auto;" /></p>
</div>
<div id="team-members" class="section level1">
<h1>Team members</h1>
<ul>
<li>Alex Kubbinga</li>
<li>Clara Moreno Sanchez</li>
<li>Jean Huang</li>
<li>Raghav Mehta</li>
<li>Raina Doshi</li>
<li>Yuan Gao</li>
</ul>
</div>
